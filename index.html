<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Equation Generator</title>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      text-align: center;
      background-color: #f0f8ff;
      margin: 20px;
    }
    .equation {
      font-size: 24px;
      margin-top: 20px;
    }
    .generate-btn {
      padding: 10px 20px;
      font-size: 16px;
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
      margin-top: 20px;
    }
    .generate-btn:hover {
      background-color: #45a049;
    }
  </style>
</head>
<body>
  <h1>Random Algebraic Equation Generator</h1>
  <div id="equation-container" class="equation">Loading...</div>
  <button class="generate-btn" onclick="renderEquation()">Generate New Equation</button>

  <script>
    // Generate a random integer between -10 and 10 (including zero)
    function getRandomInteger() {
      return Math.floor(Math.random() * 21) - 10;
    }

    // Compute the GCD of two integers
    function gcd(a, b) {
      return b === 0 ? Math.abs(a) : gcd(b, a % b);
    }

    // Generate a random coprime numerator and denominator
    function getCoprimePair() {
      let numerator, denominator;
      do {
        numerator = getRandomInteger();
        denominator = getRandomInteger();
      } while (gcd(numerator, denominator) !== 1 || denominator === 0);
      
      // Ensure the denominator is always positive
      if (denominator < 0) {
        numerator = -numerator;
        denominator = -denominator;
      }

      return [numerator, denominator];
    }

    // Format a fraction into LaTeX, handling negatives, simplifications, and denominators of 1
    function formatFraction(numerator, denominator, skipOne = true) {
      if (denominator === 0) return "0"; // Handle division by zero (though it shouldn't happen)
      let sign = numerator * denominator < 0 ? "−" : ""; // Determine the sign
      numerator = Math.abs(numerator);
      denominator = Math.abs(denominator);

      // Handle cases where the fraction simplifies to 1 or -1
      if (numerator === denominator) {
        return skipOne ? `${sign}` : `${sign}1`; // Print '-' if it's -1, nothing if it's 1
      }

      // Simplify fractions with denominator = 1
      if (denominator === 1) {
        return `${sign}${numerator}`;
      }

      // Default fraction formatting
      return `${sign}\\frac{${numerator}}{${denominator}}`;
    }

    // Generate the random equation
    function generateEquation() {
      // Generate random fractions for left-hand side
      const a = getCoprimePair();
      const b = getCoprimePair();
      const c = getCoprimePair();
      const d = getCoprimePair();
      const e = getCoprimePair();
      const f = getCoprimePair();

      // Generate random fractions for right-hand side
      const g = getCoprimePair();
      const h = getCoprimePair();
      const i = getCoprimePair();
      const j = getCoprimePair();
      const k = getCoprimePair();
      const l = getCoprimePair();

      // Check if the fraction before the bracket equals 1 (but not -1)
      const isLeftBracketNeeded = !(a[0] === a[1] && a[0] > 0);
      const isRightBracketNeeded = !(g[0] === g[1] && g[0] > 0);

      // Handle cases where c = 0 or e = 0 (left-hand side)
      let leftExpression = "";
      if (c[0] === 0 && e[0] === 0) {
        leftExpression = "0";
      } else {
        const cxTerm = c[0] === 0 ? "" : `${formatFraction(c[0], c[1])}x`;
        const eTerm = e[0] === 0 ? "" : `${e[0] < 0 ? "−" : "+"} ${formatFraction(Math.abs(e[0]), Math.abs(e[1]), false)}`;
        leftExpression = `${cxTerm} ${eTerm}`.trim();
      }

      // Handle cases where i = 0 or k = 0 (right-hand side)
      let rightExpression = "";
      if (i[0] === 0 && k[0] === 0) {
        rightExpression = "0";
      } else {
        const ixTerm = i[0] === 0 ? "" : `${formatFraction(i[0], i[1])}x`;
        const kTerm = k[0] === 0 ? "" : `${k[0] < 0 ? "−" : "+"} ${formatFraction(Math.abs(k[0]), Math.abs(k[1]), false)}`;
        rightExpression = `${ixTerm} ${kTerm}`.trim();
      }

      // Format the equation
      const leftSide = isLeftBracketNeeded
        ? `${formatFraction(a[0], a[1])}\\left(${leftExpression}\\right)`
        : `${leftExpression}`;

      const rightSide = isRightBracketNeeded
        ? `${formatFraction(g[0], g[1])}\\left(${rightExpression}\\right)`
        : `${rightExpression}`;

      return `${leftSide} = ${rightSide}`;
    }

    // Render the equation on the page
    function renderEquation() {
      const equationContainer = document.getElementById("equation-container");
      const equation = generateEquation();
      equationContainer.innerHTML = `\\[ ${equation} \\]`;
      MathJax.typesetPromise(); // Re-render MathJax content
    }

    // Initial render
    window.onload = renderEquation;
  </script>
</body>
</html>
