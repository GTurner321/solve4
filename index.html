<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Equation Generator</title>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      text-align: center;
      background-color: #f0f8ff;
      margin: 20px;
    }
    .equation {
      font-size: 24px;
      margin-top: 20px;
    }
    .generate-btn {
      padding: 10px 20px;
      font-size: 16px;
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
      margin-top: 20px;
    }
    .generate-btn:hover {
      background-color: #45a049;
    }
  </style>
</head>
<body>
  <h1>Random Algebraic Equation Generator</h1>
  <div id="equation-container" class="equation">Loading...</div>
  <button class="generate-btn" onclick="renderEquation()">Generate New Equation</button>

  <script>
    function getRandomInteger(includeZero = false) {
      const num = Math.floor(Math.random() * 21) - 10; // Range -10 to 10
      return includeZero ? num : num === 0 ? getRandomInteger(includeZero) : num; // Retry if zero is excluded
    }

    function gcd(a, b) {
      return b === 0 ? Math.abs(a) : gcd(b, a % b);
    }

    function getCoprimePair() {
      let numerator, denominator;
      do {
        numerator = getRandomInteger();
        denominator = getRandomInteger();
      } while (gcd(numerator, denominator) !== 1 || denominator === 0);
      if (denominator < 0) {
        numerator = -numerator;
        denominator = -denominator;
      }
      return [numerator, denominator];
    }

    function formatFraction(numerator, denominator, skipOne = true) {
      if (denominator === 0) return "0";
      const sign = numerator * denominator < 0 ? "−" : "";
      numerator = Math.abs(numerator);
      denominator = Math.abs(denominator);
      if (numerator === denominator) return skipOne ? `${sign}` : `${sign}1`;
      if (denominator === 1) return `${sign}${numerator}`;
      return `${sign}\\frac{${numerator}}{${denominator}}`;
    }

    function evaluateFraction(numerator1, denominator1, numerator2, denominator2) {
      const num = numerator1 * numerator2;
      const den = denominator1 * denominator2;
      const gcdValue = gcd(num, den);
      return [num / gcdValue, den / gcdValue];
    }

    function ensureDifferentFraction(fraction, denominator) {
      let newNumerator, newDenominator;
      do {
        [newNumerator, newDenominator] = getCoprimePair();
      } while (newNumerator / newDenominator === fraction[0] / fraction[1]);
      return [newNumerator, newDenominator];
    }

    function generateEquation() {
      const a = getCoprimePair();
      const b = getCoprimePair();
      const c = getCoprimePair();
      const d = getCoprimePair();
      const e = getCoprimePair();
      const f = getCoprimePair();

      const g = getCoprimePair();
      const h = getCoprimePair();
      let i = getCoprimePair();
      const j = getCoprimePair();
      const k = getCoprimePair();
      const l = getCoprimePair();

      // Ensure c/d ≠ i/j
      i = ensureDifferentFraction(c, d);

      // Handle left-hand side simplifications
      let leftTerm = "";
      if (c[0] === 0 && e[0] === 0) {
        leftTerm = "0";
      } else if (c[0] === 0) {
        leftTerm = `${e[0] < 0 ? "" : "+"}${formatFraction(e[0], e[1], false)}`;
      } else if (e[0] === 0) {
        leftTerm = `${formatFraction(c[0], c[1])}x`;
      } else {
        leftTerm = `${formatFraction(c[0], c[1])}x ${e[0] < 0 ? "" : "+"} ${formatFraction(e[0], e[1], false)}`;
      }

      if (a[0] !== a[1] && (c[0] === 0 || e[0] === 0)) {
        const [num, den] = evaluateFraction(a[0], a[1], c[0] || e[0], c[0] ? c[1] : e[1]);
        leftTerm = formatFraction(num, den);
      } else if (a[0] === a[1]) {
        leftTerm = `\\left(${leftTerm}\\right)`;
      } else {
        leftTerm = `${formatFraction(a[0], a[1])}\\left(${leftTerm}\\right)`;
      }

      // Handle right-hand side simplifications
      let rightTerm = "";
      if (i[0] === 0 && k[0] === 0) {
        rightTerm = "0";
      } else if (i[0] === 0) {
        rightTerm = `${k[0] < 0 ? "" : "+"}${formatFraction(k[0], k[1], false)}`;
      } else if (k[0] === 0) {
        rightTerm = `${formatFraction(i[0], i[1])}x`;
      } else {
        rightTerm = `${formatFraction(i[0], i[1])}x ${k[0] < 0 ? "" : "+"} ${formatFraction(k[0], k[1], false)}`;
      }

      if (g[0] !== g[1] && (i[0] === 0 || k[0] === 0)) {
        const [num, den] = evaluateFraction(g[0], g[1], i[0] || k[0], i[0] ? i[1] : k[1]);
        rightTerm = formatFraction(num, den);
      } else if (g[0] === g[1]) {
        rightTerm = `\\left(${rightTerm}\\right)`;
      } else {
        rightTerm = `${formatFraction(g[0], g[1])}\\left(${rightTerm}\\right)`;
      }

      return `${leftTerm} = ${rightTerm}`;
    }

    function renderEquation() {
      const container = document.getElementById("equation-container");
      const equation = generateEquation();
      container.innerHTML = `\\[ ${equation} \\]`;
      MathJax.typesetPromise();
    }

    window.onload = renderEquation;
  </script>
</body>
</html>
